<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boutique Novaruiina -</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Mono:wght@300;400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto Mono', monospace;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d1b1b 50%, #1a1a1a 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animation d'arrière-plan */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 69, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 69, 19, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 140, 0, 0.05) 0%, transparent 50%);
            z-index: -1;
            animation: ambientGlow 10s ease-in-out infinite alternate;
        }

        @keyframes ambientGlow {
            0% { opacity: 0.3; }
            100% { opacity: 0.7; }
        }

        /* Header */
        header {
            background: linear-gradient(45deg, #2c1810, #3d2317);
            border-bottom: 3px solid #ff4500;
            padding: 1rem 0;
            box-shadow: 0 4px 20px rgba(255, 69, 0, 0.3);
        }

        nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            font-weight: 900;
            color: #ff4500;
            text-shadow: 0 0 10px rgba(255, 69, 0, 0.5);
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: linear-gradient(45deg, #3d2317, #2c1810);
            color: #e0e0e0;
            border: 2px solid #ff4500;
            border-radius: 5px;
            font-family: 'Roboto Mono', monospace;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            background: linear-gradient(45deg, #ff4500, #ff6500);
            box-shadow: 0 0 15px rgba(255, 69, 0, 0.6);
            transform: translateY(-2px);
        }

        /* Container principal */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Section boutique */
        .shop-section {
            display: block;
        }

        .shop-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .shop-title {
            font-family: 'Orbitron', monospace;
            font-size: 3rem;
            color: #ff4500;
            text-shadow: 0 0 20px rgba(255, 69, 0, 0.5);
            margin-bottom: 1rem;
        }

        .shop-subtitle {
            font-size: 1.2rem;
            color: #b0b0b0;
            font-style: italic;
        }

        /* Grille des véhicules */
        .vehicles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .vehicle-card {
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            border: 2px solid #444;
            border-radius: 10px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .vehicle-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 69, 0, 0.1), transparent);
            transition: left 0.5s;
        }

        .vehicle-card:hover::before {
            left: 100%;
        }

        .vehicle-card:hover {
            border-color: #ff4500;
            box-shadow: 0 10px 30px rgba(255, 69, 0, 0.3);
            transform: translateY(-5px);
        }

        .vehicle-image {
            width: 100%;
            height: 200px;
            background: #333;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #666;
        }

        .vehicle-name {
            font-family: 'Orbitron', monospace;
            font-size: 1.3rem;
            color: #ff4500;
            margin-bottom: 0.5rem;
        }

        .vehicle-price {
            font-family: 'Roboto Mono', monospace;
            font-size: 1.1rem;
            color: #4ade80;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .vehicle-description {
            color: #b0b0b0;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 1.5rem;
        }

        .vehicle-category {
            font-size: 0.9rem;
            color: #4ade80;
            font-weight: bold;
            margin-bottom: 0.5rem;
            padding: 0.2rem 0.5rem;
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid #4ade80;
            border-radius: 3px;
            display: inline-block;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Menu déroulant des détails */
        .vehicle-details-menu {
            background: linear-gradient(145deg, #1a1a1a, #0f0f0f);
            border: 2px solid #ff4500;
            border-radius: 8px;
            margin: 1rem 0;
            padding: 1rem;
            box-shadow: 0 5px 15px rgba(255, 69, 0, 0.2);
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .details-photos {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.75rem;
        }

        .detail-photo {
            background: #2a2a2a;
            border-radius: 5px;
            overflow: hidden;
            border: 1px solid #444;
            transition: all 0.3s ease;
        }

        .detail-photo:hover {
            border-color: #ff4500;
            box-shadow: 0 3px 10px rgba(255, 69, 0, 0.3);
            transform: scale(1.02);
            cursor: pointer;
        }

        /* Lightbox pour affichage en grand des images */
        .lightbox {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease-out;
        }

        .lightbox.show {
            display: flex;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            background: #1a1a1a;
            border: 3px solid #ff4500;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(255, 69, 0, 0.5);
            animation: zoomIn 0.3s ease-out;
        }

        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .lightbox-image {
            width: 100%;
            height: auto;
            max-height: 80vh;
            object-fit: contain;
            display: block;
        }

        .lightbox-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: rgba(255, 69, 0, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 1001;
        }

        .lightbox-close:hover {
            background: #ff6500;
            transform: scale(1.1);
        }

        .lightbox-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            color: white;
            padding: 20px;
            text-align: center;
        }

        .lightbox-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            color: #ff4500;
            margin-bottom: 0.5rem;
        }

        .lightbox-description {
            font-size: 0.9rem;
            color: #e0e0e0;
        }

        /* Styles responsifs */
        @media (max-width: 768px) {
            .nav-buttons {
                flex-direction: column;
                gap: 0.5rem;
            }

            .shop-title {
                font-size: 2rem;
            }

            .vehicles-grid {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 1rem;
            }

            .login-form {
                margin: 1rem;
                padding: 2rem;
            }

            .admin-content {
                margin: 1rem;
                padding: 1rem;
            }

            .admin-form {
                padding: 1rem;
            }

            .login-title {
                font-size: 1.5rem;
            }

            .admin-title {
                font-size: 1.3rem;
            }

            .admin-vehicle-item {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .admin-vehicle-actions {
                width: 100%;
                justify-content: center;
            }
        }

        /* Animation d'apparition */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .vehicle-card {
            animation: slideIn 0.6s ease-out;
        }

        /* === STYLES PANEL ADMIN === */
        .admin-panel {
            display: none;
            min-height: 80vh;
            animation: slideIn 0.6s ease-out;
        }

        .login-form {
            max-width: 500px;
            margin: 3rem auto;
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            border: 3px solid #ff4500;
            border-radius: 15px;
            padding: 3rem;
            text-align: center;
            box-shadow: 0 15px 35px rgba(255, 69, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .login-form::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 69, 0, 0.05), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .login-title {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            color: #ff4500;
            text-shadow: 0 0 20px rgba(255, 69, 0, 0.7);
            margin-bottom: 1rem;
            letter-spacing: 2px;
            position: relative;
            z-index: 1;
        }

        .login-subtitle {
            color: #b0b0b0;
            font-size: 1rem;
            margin-bottom: 2rem;
            font-style: italic;
            position: relative;
            z-index: 1;
        }

        .admin-content {
            display: none;
            max-width: 800px;
            margin: 0 auto;
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            border: 2px solid #444;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .admin-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff4500, #ff6500, #ff4500);
            border-radius: 15px 15px 0 0;
        }

        .admin-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            color: #ff4500;
            text-shadow: 0 0 15px rgba(255, 69, 0, 0.6);
            margin-bottom: 0;
            letter-spacing: 1px;
        }

        .admin-form {
            background: linear-gradient(145deg, #1f1f1f, #0f0f0f);
            border: 1px solid #444;
            border-radius: 10px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            z-index: 1;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            font-family: 'Roboto Mono', monospace;
            font-weight: 700;
            color: #ff4500;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(145deg, #333, #222);
            border: 2px solid #444;
            border-radius: 8px;
            color: #e0e0e0;
            font-family: 'Roboto Mono', monospace;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #ff4500;
            box-shadow: 0 0 15px rgba(255, 69, 0, 0.3);
            background: linear-gradient(145deg, #3a3a3a, #2a2a2a);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: #666;
            font-style: italic;
        }

        /* Section de gestion des véhicules */
        .vehicle-management {
            background: linear-gradient(145deg, #1f1f1f, #0f0f0f);
            border: 1px solid #444;
            border-radius: 10px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .management-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.3rem;
            color: #4ade80;
            text-shadow: 0 0 10px rgba(74, 222, 128, 0.5);
            margin: 0;
            letter-spacing: 1px;
        }

        .vehicle-list {
            margin-top: 1rem;
        }

        .admin-vehicle-item {
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 1rem;
            align-items: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .admin-vehicle-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 69, 0, 0.05), transparent);
            transition: left 0.5s;
        }

        .admin-vehicle-item:hover::before {
            left: 100%;
        }

        .admin-vehicle-item:hover {
            border-color: #ff4500;
            box-shadow: 0 5px 15px rgba(255, 69, 0, 0.2);
            transform: translateY(-2px);
        }

        .admin-vehicle-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
            align-items: center;
        }

        .admin-vehicle-name {
            font-family: 'Orbitron', monospace;
            color: #ff4500;
            font-weight: bold;
            font-size: 1rem;
        }

        .admin-vehicle-category {
            color: #4ade80;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: rgba(74, 222, 128, 0.1);
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            text-align: center;
            border: 1px solid #4ade80;
        }

        .admin-vehicle-price {
            color: #fbbf24;
            font-weight: bold;
            font-family: 'Roboto Mono', monospace;
            text-align: right;
        }

        .admin-vehicle-price::before {
            content: "💰 ";
        }

        .admin-vehicle-price::after {
            content: " SC";
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* Menu de navigation amélioré */
        nav {
            background: linear-gradient(45deg, #2c1810, #3d2317);
            padding: 1rem 2rem;
            border-bottom: 3px solid #ff4500;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 10;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
        }

        /* Animation des boutons de navigation */
        .btn {
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background: rgba(255, 69, 0, 0.3);
            transition: transform 0.3s ease;
            border-radius: 50%;
            z-index: 0;
            transform: translate(-50%, -50%) scale(0);
        }

        .btn:hover::before {
            transform: translate(-50%, -50%) scale(1);
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        /* Header de connexion */
        .login-header {
            margin-bottom: 2rem;
            position: relative;
            z-index: 1;
        }

        .login-footer {
            margin-top: 2rem;
            position: relative;
            z-index: 1;
        }

        .login-footer small {
            color: #888;
            font-size: 0.8rem;
            font-style: italic;
        }

        /* Boutons spécialisés */
        .btn-login {
            background: linear-gradient(45deg, #4ade80, #22c55e) !important;
            border: 2px solid #4ade80 !important;
            font-weight: 900;
            letter-spacing: 2px;
            padding: 1rem 2rem;
            width: 100%;
            font-size: 1.1rem;
        }

        .btn-login:hover {
            background: linear-gradient(45deg, #22c55e, #16a34a) !important;
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.6) !important;
        }

        .btn-logout {
            background: linear-gradient(45deg, #dc2626, #b91c1c) !important;
            border: 2px solid #dc2626 !important;
            font-size: 0.9rem;
            padding: 0.8rem 1.5rem;
        }

        .btn-logout:hover {
            background: linear-gradient(45deg, #ef4444, #dc2626) !important;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.6) !important;
        }

        .btn-primary {
            background: linear-gradient(45deg, #3b82f6, #2563eb) !important;
            border: 2px solid #3b82f6 !important;
            font-weight: 900;
            letter-spacing: 1px;
            padding: 1rem 2rem;
            width: 100%;
            font-size: 1.1rem;
        }

        .btn-primary:hover {
            background: linear-gradient(45deg, #2563eb, #1d4ed8) !important;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.6) !important;
        }

        .btn-danger {
            background: linear-gradient(45deg, #dc2626, #b91c1c) !important;
            border: 2px solid #dc2626 !important;
        }

        .btn-danger:hover {
            background: linear-gradient(45deg, #ef4444, #dc2626) !important;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.6) !important;
        }

        /* Boutons petits */
        .btn-small {
            padding: 0.5rem 1rem !important;
            font-size: 0.85rem !important;
            min-width: auto !important;
        }

        /* Boutons de catégories */
        .category-btn {
            padding: 0.6rem 1.2rem;
            background: linear-gradient(45deg, #333, #222);
            color: #b0b0b0;
            border: 2px solid #555;
            border-radius: 25px;
            font-family: 'Roboto Mono', monospace;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }

        .category-btn:hover {
            background: linear-gradient(45deg, #444, #333);
            border-color: #ff4500;
            color: #ff4500;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 69, 0, 0.3);
        }

        .category-btn.active {
            background: linear-gradient(45deg, #ff4500, #ff6500);
            border-color: #ff4500;
            color: white;
            box-shadow: 0 5px 15px rgba(255, 69, 0, 0.5);
        }

        /* Header admin */
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #444;
        }

        .admin-title-section {
            flex: 1;
        }

        .admin-subtitle {
            color: #b0b0b0;
            font-size: 1rem;
            margin: 0.5rem 0 0 0;
            font-style: italic;
        }

        /* Sections du formulaire */
        .form-section {
            margin-bottom: 3rem;
        }

        .section-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            color: #4ade80;
            text-shadow: 0 0 10px rgba(74, 222, 128, 0.5);
            margin-bottom: 1rem;
            letter-spacing: 1px;
            border-left: 4px solid #4ade80;
            padding-left: 1rem;
        }

        /* Rangées de formulaire */
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        /* Aide contextuelle */
        .input-help {
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            border: 1px solid #444;
            border-radius: 5px;
            padding: 1rem;
            margin-top: 0.5rem;
            font-size: 0.8rem;
        }

        .help-item {
            color: #b0b0b0;
            margin-bottom: 0.5rem;
            padding-left: 1rem;
            position: relative;
        }

        .help-item:last-child {
            margin-bottom: 0;
        }

        .help-item::before {
            content: "▶";
            color: #ff4500;
            position: absolute;
            left: 0;
            top: 0;
        }

        /* Preview d'image amélioré */
        .preview-label {
            color: #ff4500;
            font-weight: bold;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        /* Header de gestion */
        .management-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #444;
        }

        .management-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Améliorations des éléments de véhicule admin */
        .admin-vehicle-item {
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 1rem;
            align-items: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .admin-vehicle-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 69, 0, 0.05), transparent);
            transition: left 0.5s;
        }

        .admin-vehicle-item:hover::before {
            left: 100%;
        }

        .admin-vehicle-item:hover {
            border-color: #ff4500;
            box-shadow: 0 5px 15px rgba(255, 69, 0, 0.2);
            transform: translateY(-2px);
        }

        .admin-vehicle-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
            align-items: center;
        }

        .admin-vehicle-name {
            font-family: 'Orbitron', monospace;
            color: #ff4500;
            font-weight: bold;
            font-size: 1rem;
        }

        .admin-vehicle-category {
            color: #4ade80;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: rgba(74, 222, 128, 0.1);
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            text-align: center;
            border: 1px solid #4ade80;
        }

        .admin-vehicle-price {
            color: #fbbf24;
            font-weight: bold;
            font-family: 'Roboto Mono', monospace;
            text-align: right;
        }

        .admin-vehicle-price::before {
            content: "💰 ";
        }

        .admin-vehicle-price::after {
            content: " SC";
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* État vide */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #666;
            font-style: italic;
        }

        .empty-state::before {
            content: "🚗";
            font-size: 3rem;
            display: block;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Responsive pour mobile */
        @media (max-width: 768px) {
            .admin-header {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }

            .management-header {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }

            .admin-vehicle-item {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .admin-vehicle-info {
                grid-template-columns: 1fr;
                gap: 0.5rem;
                text-align: center;
            }

            .admin-vehicle-actions {
                justify-content: center;
            }

            .admin-vehicle-price {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">Boutique Véhicules Novaruiina</div>
            <div class="nav-buttons">
                <button class="btn" onclick="showShop()">Boutique</button>
                <button class="btn" onclick="showAdmin()">Panel Admin</button>
            </div>
        </nav>
    </header>

    <div class="container">
        <!-- Section Boutique -->
        <section id="shop-section" class="shop-section">
            <div class="shop-header">
                <h1 class="shop-title">VÉHICULES POST-APOCALYPTIQUES</h1>
                <p class="shop-subtitle">Les meilleurs véhicules pour survivre sur Novaruiina</p>
                
                <!-- Filtres par catégorie -->
                <div class="category-filters" style="margin-top: 2rem; display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
                    <button class="category-btn active" onclick="filterByCategory('all')">Tous</button>
                    <button class="category-btn" onclick="filterByCategory('Camion')">Camions</button>
                    <button class="category-btn" onclick="filterByCategory('Moto')">Motos</button>
                    <button class="category-btn" onclick="filterByCategory('Import')">Import</button>
                    <button class="category-btn" onclick="filterByCategory('Remorque')">Remorques</button>
                </div>
            </div>
            
            <div id="vehicles-container" class="vehicles-grid">
                <!-- Les véhicules seront générés dynamiquement ici -->
            </div>
        </section>

        <!-- Panel Admin -->
        <section id="admin-panel" class="admin-panel">
            <!-- Formulaire de connexion -->
            <div id="login-form" class="login-form">
                <div class="login-header">
                    <h2 class="login-title">🔒 ACCÈS SÉCURISÉ 🔒</h2>
                    <p class="login-subtitle">Zone réservée aux administrateurs de Novaruiina</p>
                </div>
                
                <div id="login-message-container"></div>
                
                <form id="login-form-element" class="admin-form">
                    <div class="form-group">
                        <label for="username">🔑 Identifiant</label>
                        <input type="text" id="username" name="username" placeholder="Entrez votre identifiant" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">🔐 Mot de passe</label>
                        <input type="password" id="password" name="password" placeholder="Entrez votre mot de passe" required>
                    </div>
                    
                    <button type="submit" class="btn btn-login">🚀 SE CONNECTER</button>
                </form>
                
                <div class="login-footer">
                    <small>⚠️ Accès strictement réservé au personnel autorisé</small>
                </div>
            </div>

            <!-- Contenu admin (caché par défaut) -->
            <div id="admin-content" class="admin-content">
                <div class="admin-header">
                    <div class="admin-title-section">
                        <h2 class="admin-title">🔧 PANEL ADMINISTRATEUR 🔧</h2>
                        <p class="admin-subtitle">Gestion des véhicules de la boutique Novaruiina</p>
                    </div>
                    <button class="btn btn-logout" onclick="logout()">
                        🚪 DÉCONNEXION
                    </button>
                </div>
                
                <div id="message-container"></div>
                
                <!-- Formulaire d'ajout de véhicule -->
                <div class="form-section">
                    <h3 class="section-title">➕ AJOUTER UN NOUVEAU VÉHICULE</h3>
                    <form id="vehicle-form" class="admin-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="vehicle-name">🏷️ Nom du véhicule</label>
                                <input type="text" id="vehicle-name" name="name" placeholder="Ex: Apocalypse Buggy" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="vehicle-category">📂 Catégorie</label>
                                <select id="vehicle-category" name="category" required>
                                    <option value="">Sélectionner une catégorie</option>
                                    <option value="Camion">🚛 Camion</option>
                                    <option value="Moto">🏍️ Moto</option>
                                    <option value="Import">📦 Import</option>
                                    <option value="Remorque">🚛 Remorque</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicle-price">💰 Prix (Secret Coins)</label>
                            <input type="number" id="vehicle-price" name="price" placeholder="Ex: 50000" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicle-description">📝 Description</label>
                            <textarea id="vehicle-description" name="description" placeholder="Décrivez les caractéristiques et avantages du véhicule..." required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicle-image">🖼️ URLs des images Discord</label>
                            <input type="text" id="vehicle-image" name="image" placeholder="https://cdn.discordapp.com/attachments/..., https://..." oninput="previewImage(this.value)">
                            <div class="input-help">
                                <div class="help-item">
                                    <strong>📸 Première image :</strong> Affichée sur la carte principale
                                </div>
                                <div class="help-item">
                                    <strong>🖼️ Images supplémentaires :</strong> Visibles dans le menu "Details" (séparez par des virgules)
                                </div>
                                <div class="help-item">
                                    <strong>💡 Astuce :</strong> Clic droit sur l'image Discord → "Copier le lien de l'image"
                                </div>
                            </div>
                            <div id="image-preview" style="margin-top: 1rem; display: none;">
                                <div class="preview-label">Aperçu de la première image :</div>
                                <img id="preview-img" style="max-width: 200px; max-height: 150px; border-radius: 5px; border: 2px solid #ff4500;">
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">✨ AJOUTER LE VÉHICULE</button>
                    </form>
                </div>

                <!-- Section de gestion des véhicules -->
                <div class="vehicle-management">
                    <div class="management-header">
                        <h3 class="management-title">📋 GESTION DES VÉHICULES</h3>
                        <div class="management-actions">
                            <button class="btn btn-danger btn-small" onclick="resetVehicles()">
                                🗑️ RÉINITIALISER TOUT
                            </button>
                        </div>
                    </div>
                    <div id="admin-vehicle-list" class="vehicle-list">
                        <!-- Liste des véhicules pour administration -->
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script>
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDaVzNSdFyU1bnLaIoRRmKX5-UDALB5q_I",
            authDomain: "novaruiina-boutique.firebaseapp.com",
            projectId: "novaruiina-boutique",
            storageBucket: "novaruiina-boutique.firebasestorage.app",
            messagingSenderId: "182489662939",
            appId: "1:182489662939:web:50a7b7cee4db4ea12993fe"
        };

        // Initialiser Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Variables globales
        let vehicles = [];
        let nextId = 1;
        let isLoggedIn = false;
        let currentFilter = 'all';
        let firebaseConnected = false;

        // Identifiants d'accès
        const ADMIN_CREDENTIALS = {
            username: "admin",
            password: "Novaruiina2025"
        };

        // Véhicules par défaut
        const defaultVehicles = [
            {
                id: 1,
                name: "Terrabit",
                price: 45000,
                description: "Véhicule tout-terrain blindé, parfait pour traverser les zones radioactives.",
                image: "🏎️",
                category: "Import"
            },
            {
                id: 2,
                name: "Wasteland Truck",
                price: 75000,
                description: "Camion lourd avec armure renforcée et capacité de transport maximale.",
                image: "🚛",
                category: "Camion"
            },
            {
                id: 3,
                name: "Desert Raider",
                price: 35000,
                description: "Moto rapide et agile pour les raids dans le désert post-apocalyptique.",
                image: "🏍️",
                category: "Moto"
            },
            {
                id: 4,
                name: "Armored Beast",
                price: 95000,
                description: "Tank civil modifié avec tourelle défensive et blindage maximal.",
                image: "🚗",
                category: "Import"
            }
        ];

        // Test de connexion Firebase amélioré
        async function testFirebaseConnection() {
            try {
                console.log('🔄 Test de connexion Firebase...');
                
                // Test d'écriture simple
                const testDoc = {
                    test: true,
                    timestamp: new Date().toISOString()
                };
                
                const docRef = await db.collection('test').add(testDoc);
                console.log('✅ Test d\'écriture réussi, ID:', docRef.id);
                
                // Nettoyer le test
                await db.collection('test').doc(docRef.id).delete();
                console.log('✅ Test de suppression réussi');
                
                firebaseConnected = true;
                console.log('✅ Firebase connecté et opérationnel');
                return true;
                
            } catch (error) {
                console.error('❌ Erreur de connexion Firebase:', error);
                console.error('📋 Code d\'erreur:', error.code);
                console.error('📋 Message:', error.message);
                
                firebaseConnected = false;
                return false;
            }
        }

        // Charger les véhicules (VERSION SANS DÉFAUT)
        async function loadVehicles() {
            console.log('🔄 Chargement des véhicules...');
            
            // Tester la connexion Firebase
            const connected = await testFirebaseConnection();
            
            if (connected) {
                try {
                    const snapshot = await db.collection('vehicles').orderBy('id').get();
                    vehicles = [];
                    let maxId = 0;
                    
                    snapshot.forEach(doc => {
                        const vehicle = { ...doc.data(), firestoreId: doc.id };
                        vehicles.push(vehicle);
                        if (vehicle.id > maxId) maxId = vehicle.id;
                    });
                    
                    nextId = maxId + 1;
                    
                    // NE PAS créer de véhicules par défaut
                    if (vehicles.length === 0) {
                        console.log('ℹ️ Aucun véhicule - base vide');
                        nextId = 1;
                    }
                    
                    console.log('✅ Véhicules chargés depuis Firebase:', vehicles.length);
                    
                } catch (error) {
                    console.error('❌ Erreur lors du chargement Firebase:', error);
                    loadVehiclesFromLocalStorage();
                }
            } else {
                console.log('📱 Utilisation du localStorage (mode hors ligne)');
                loadVehiclesFromLocalStorage();
            }
            
            renderVehicles();
        }

        // Créer les véhicules par défaut dans Firebase
        async function createDefaultVehicles() {
            try {
                for (const vehicle of defaultVehicles) {
                    const docRef = await db.collection('vehicles').add(vehicle);
                    vehicle.firestoreId = docRef.id;
                    vehicles.push({ ...vehicle });
                }
                nextId = defaultVehicles.length + 1;
                console.log('✅ Véhicules par défaut créés dans Firebase');
            } catch (error) {
                console.error('❌ Erreur création véhicules par défaut:', error);
                vehicles = [...defaultVehicles];
                nextId = defaultVehicles.length + 1;
                saveVehiclesToLocalStorage();
            }
        }

        // Sauvegarder un véhicule dans Firebase
        async function saveVehicleToFirebase(vehicle) {
            if (!firebaseConnected) {
                throw new Error('Firebase non disponible');
            }
            
            try {
                console.log('💾 Sauvegarde véhicule dans Firebase:', vehicle);
                const docRef = await db.collection('vehicles').add(vehicle);
                console.log('✅ Véhicule sauvegardé avec ID:', docRef.id);
                return docRef.id;
            } catch (error) {
                console.error('❌ Erreur sauvegarde Firebase:', error);
                throw error;
            }
        }

        // Supprimer un véhicule de Firebase
        async function deleteVehicleFromFirebase(firestoreId) {
            if (!firebaseConnected || !firestoreId) {
                throw new Error('Firebase non disponible ou ID manquant');
            }
            
            try {
                await db.collection('vehicles').doc(firestoreId).delete();
                console.log('✅ Véhicule supprimé de Firebase');
            } catch (error) {
                console.error('❌ Erreur suppression Firebase:', error);
                throw error;
            }
        }

        // Fallback localStorage (VERSION SANS DÉFAUT)
        function loadVehiclesFromLocalStorage() {
            const savedVehicles = localStorage.getItem('wasteland_vehicles');
            const savedNextId = localStorage.getItem('wasteland_nextId');
            
            if (savedVehicles) {
                vehicles = JSON.parse(savedVehicles);
                nextId = savedNextId ? parseInt(savedNextId) : getMaxId() + 1;
                console.log('📱 Véhicules chargés depuis localStorage:', vehicles.length);
            } else {
                // Base vide - aucun véhicule par défaut
                vehicles = [];
                nextId = 1;
                console.log('ℹ️ Base vide - aucun véhicule');
            }
        }

        function saveVehiclesToLocalStorage() {
            localStorage.setItem('wasteland_vehicles', JSON.stringify(vehicles));
            localStorage.setItem('wasteland_nextId', nextId.toString());
            console.log('💾 Sauvegarde localStorage effectuée');
        }

        function getMaxId() {
            return vehicles.length > 0 ? Math.max(...vehicles.map(v => v.id)) : 0;
        }

        // Ajouter un véhicule avec debug renforcé
        async function addVehicle(vehicleData) {
            console.log('➕ Début ajout véhicule:', vehicleData);
            
            // Validation
            if (!vehicleData.name || !vehicleData.category || !vehicleData.price || !vehicleData.description) {
                showMessage('Veuillez remplir tous les champs obligatoires!', 'error');
                return;
            }

            const newVehicle = {
                id: nextId,
                name: vehicleData.name,
                price: parseInt(vehicleData.price),
                description: vehicleData.description,
                image: vehicleData.image || '🚗',
                category: vehicleData.category,
                createdAt: new Date().toISOString() // Timestamp pour debug
            };

            console.log('🚗 Véhicule à sauvegarder:', newVehicle);
            console.log('🔗 Firebase connecté:', firebaseConnected);

            try {
                // TOUJOURS essayer Firebase d'abord si connecté
                if (firebaseConnected) {
                    console.log('📤 Tentative de sauvegarde Firebase...');
                    
                    const docRef = await db.collection('vehicles').add(newVehicle);
                    newVehicle.firestoreId = docRef.id;
                    
                    console.log('✅ Véhicule sauvegardé dans Firebase avec ID:', docRef.id);
                    showMessage(`✅ Véhicule "${newVehicle.name}" ajouté dans Firebase et "${newVehicle.category}"!`, 'success');
                } else {
                    console.log('⚠️ Firebase non connecté - sauvegarde localStorage uniquement');
                    showMessage(`⚠️ Véhicule "${newVehicle.name}" ajouté en mode hors ligne!`, 'success');
                }
                
                // Ajouter à la liste locale
                vehicles.push(newVehicle);
                nextId++;
                
                // Backup localStorage
                saveVehiclesToLocalStorage();
                
                // Mettre à jour les affichages
                renderAdminVehicleList();
                renderVehicles(currentFilter);
                
                console.log('🎉 Ajout terminé avec succès');
                
            } catch (error) {
                console.error('❌ ERREUR lors de la sauvegarde Firebase:', error);
                console.error('📋 Détails de l\'erreur:', error.message);
                
                // Fallback localStorage en cas d'erreur Firebase
                vehicles.push(newVehicle);
                nextId++;
                saveVehiclesToLocalStorage();
                
                showMessage(`⚠️ Véhicule ajouté en mode hors ligne. Erreur Firebase: ${error.message}`, 'error');
                renderAdminVehicleList();
                renderVehicles(currentFilter);
            }
        }

        // Supprimer un véhicule (VERSION CORRIGÉE)
        async function deleteVehicle(id) {
            const vehicleIndex = vehicles.findIndex(v => v.id === id);
            if (vehicleIndex === -1) {
                showMessage('Véhicule non trouvé!', 'error');
                return;
            }

            const vehicle = vehicles[vehicleIndex];
            const vehicleName = vehicle.name;
            
            try {
                if (firebaseConnected && vehicle.firestoreId) {
                    await deleteVehicleFromFirebase(vehicle.firestoreId);
                }
                
                // Supprimer de la liste locale
                vehicles.splice(vehicleIndex, 1);
                
                // Sauvegarder en localStorage
                saveVehiclesToLocalStorage();
                
                showMessage(`✅ Véhicule "${vehicleName}" supprimé avec succès!`, 'success');
                
                // Mettre à jour les affichages
                renderAdminVehicleList();
                renderVehicles(currentFilter);
                
            } catch (error) {
                console.error('❌ Erreur suppression:', error);
                showMessage(`❌ Erreur lors de la suppression: ${error.message}`, 'error');
            }
        }

        // Validation URL Discord
        function isValidDiscordImageUrl(url) {
            if (!url) return true;
            return url.includes('cdn.discordapp.com') || 
                   url.includes('media.discordapp.net') || 
                   url.startsWith('https://');
        }

        // Prévisualisation image (prend la première URL si plusieurs sont saisies)
        function previewImage(urls) {
            const preview = document.getElementById('image-preview');
            const previewImg = document.getElementById('preview-img');
            
            if (urls) {
                // Prendre la première URL de la liste
                const firstUrl = urls.split(',')[0].trim();
                
                if (firstUrl && isValidDiscordImageUrl(firstUrl)) {
                    previewImg.src = firstUrl;
                    previewImg.onload = () => preview.style.display = 'block';
                    previewImg.onerror = () => preview.style.display = 'none';
                } else {
                    preview.style.display = 'none';
                }
            } else {
                preview.style.display = 'none';
            }
        }

        // Reste des fonctions (navigation, rendu, etc.)
        function showShop() {
            document.getElementById('shop-section').style.display = 'block';
            document.getElementById('admin-panel').style.display = 'none';
            renderVehicles(currentFilter);
        }

        function showAdmin() {
            document.getElementById('shop-section').style.display = 'none';
            document.getElementById('admin-panel').style.display = 'block';
            
            if (!isLoggedIn) {
                showLoginForm();
            } else {
                showAdminContent();
            }
        }

        function showLoginForm() {
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('admin-content').style.display = 'none';
        }

        function showAdminContent() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('admin-content').style.display = 'block';
            renderAdminVehicleList();
        }

        function login(username, password) {
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                isLoggedIn = true;
                showLoginMessage('Connexion réussie ! Bienvenue administrateur.', 'success');
                setTimeout(showAdminContent, 1000);
                return true;
            } else {
                showLoginMessage('Identifiant ou mot de passe incorrect !', 'error');
                return false;
            }
        }

        function logout() {
            isLoggedIn = false;
            showLoginForm();
            showLoginMessage('Déconnexion réussie.', 'success');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        function filterByCategory(category) {
            currentFilter = category;
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                if ((category === 'all' && btn.textContent === 'Tous') ||
                    (category === 'Camion' && btn.textContent === 'Camions') ||
                    (category === 'Moto' && btn.textContent === 'Motos') ||
                    (category === 'Import' && btn.textContent === 'Import') ||
                    (category === 'Remorque' && btn.textContent === 'Remorques')) {
                    btn.classList.add('active');
                }
            });
            
            renderVehicles(category);
        }

        function renderVehicles(filterCategory = null) {
            const container = document.getElementById('vehicles-container');
            container.innerHTML = '';

            let filteredVehicles = vehicles;
            if (filterCategory && filterCategory !== 'all') {
                filteredVehicles = vehicles.filter(vehicle => vehicle.category === filterCategory);
            }

            filteredVehicles.forEach(vehicle => {
                const vehicleCard = document.createElement('div');
                vehicleCard.className = 'vehicle-card';
                
                let imageContent;
                if (vehicle.image) {
                    // Prendre la première image de la liste pour l'affichage principal
                    const firstImage = vehicle.image.split(',')[0].trim();
                    
                    if (firstImage && (firstImage.startsWith('http') || firstImage.startsWith('https'))) {
                        imageContent = `<img src="${firstImage}" alt="${vehicle.name}" 
                                             style="width: 100%; height: 100%; object-fit: cover; border-radius: 5px; cursor: pointer;" 
                                             onclick="openLightbox('${firstImage}', '${vehicle.name.replace(/'/g, "\\'")}')"
                                             onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                       <div style="display: none; width: 100%; height: 100%; align-items: center; justify-content: center; font-size: 3rem; color: #666;">🚗</div>`;
                    } else {
                        imageContent = firstImage || '🚗';
                    }
                } else {
                    imageContent = vehicle.image || '🚗';
                }
                
                vehicleCard.innerHTML = `
                    <div class="vehicle-image">${imageContent}</div>
                    
                    <!-- Menu déroulant des photos détails -->
                    <div id="vehicle-details-${vehicle.id}" class="vehicle-details-menu" style="display: none;">
                        <div class="details-photos">
                            ${renderDetailPhotos(vehicle)}
                        </div>
                    </div>
                    
                    <div class="vehicle-category">${vehicle.category || 'Non classé'}</div>
                    <h3 class="vehicle-name">${vehicle.name}</h3>
                    <div class="vehicle-price">${vehicle.price.toLocaleString()} Secret Coins</div>
                    <p class="vehicle-description">${vehicle.description}</p>
                    <button class="btn" onclick="toggleVehicleDetails(${vehicle.id})">Details</button>
                    
                `;
                container.appendChild(vehicleCard);
            });
        }

        function renderAdminVehicleList() {
            const container = document.getElementById('admin-vehicle-list');
            container.innerHTML = '';

            if (vehicles.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        Aucun véhicule enregistré pour le moment.<br>
                        Ajoutez votre premier véhicule avec le formulaire ci-dessus !
                    </div>
                `;
                return;
            }

            vehicles.forEach(vehicle => {
                const vehicleItem = document.createElement('div');
                vehicleItem.className = 'admin-vehicle-item';
                vehicleItem.innerHTML = `
                    <div class="admin-vehicle-info">
                        <div class="admin-vehicle-name">${vehicle.name}</div>
                        <div class="admin-vehicle-category">${vehicle.category || 'Non classé'}</div>
                        <div class="admin-vehicle-price">${vehicle.price.toLocaleString()}</div>
                    </div>
                    <div class="admin-vehicle-actions">
                        <button class="btn-small btn-danger" onclick="deleteVehicle(${vehicle.id})">
                            🗑️ Supprimer
                        </button>
                    </div>
                `;
                container.appendChild(vehicleItem);
            });
        }

        // Fonction pour afficher les images supplémentaires dans le menu déroulant
        function renderDetailPhotos(vehicle) {
            if (!vehicle.image) {
                return '<p style="color: #666; text-align: center; padding: 1rem;">Aucune image disponible</p>';
            }

            // Diviser les images par des virgules et nettoyer les espaces
            const images = vehicle.image.split(',').map(img => img.trim()).filter(img => img.length > 0);
            
            if (images.length <= 1) {
                return '<p style="color: #666; text-align: center; padding: 1rem;">Aucune image supplémentaire</p>';
            }

            // Afficher toutes les images sauf la première (qui est déjà affichée sur la carte)
            const additionalImages = images.slice(1);
            
            return additionalImages.map(image => {
                if (image.startsWith('http') || image.startsWith('https')) {
                    return `
                        <div class="detail-photo">
                            <img src="${image}" alt="${vehicle.name}" 
                                 style="width: 100%; height: 120px; object-fit: cover; border-radius: 5px; margin-bottom: 0.5rem; cursor: pointer;"
                                 onclick="openLightbox('${image}', '${vehicle.name.replace(/'/g, "\\'")}')"
                                 onerror="this.style.display='none';">
                        </div>
                    `;
                } else {
                    return `
                        <div class="detail-photo" style="display: flex; align-items: center; justify-content: center; height: 120px; font-size: 2rem; background: #f3f4f6; border-radius: 5px; margin-bottom: 0.5rem;">
                            ${image}
                        </div>
                    `;
                }
            }).join('');
        }

        // Fonction pour basculer l'affichage du menu déroulant de détails
        function toggleVehicleDetails(vehicleId) {
            const detailsMenu = document.getElementById(`vehicle-details-${vehicleId}`);
            
            if (detailsMenu) {
                if (detailsMenu.style.display === 'none' || detailsMenu.style.display === '') {
                    // Fermer tous les autres menus ouverts
                    const allDetailsMenus = document.querySelectorAll('.vehicle-details-menu');
                    allDetailsMenus.forEach(menu => {
                        if (menu.id !== `vehicle-details-${vehicleId}`) {
                            menu.style.display = 'none';
                        }
                    });
                    
                    // Ouvrir le menu actuel
                    detailsMenu.style.display = 'block';
                    
                    // Faire défiler vers le menu avec une animation douce
                    setTimeout(() => {
                        detailsMenu.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'nearest' 
                        });
                    }, 100);
                } else {
                    // Fermer le menu
                    detailsMenu.style.display = 'none';
                }
            }
        }

        // Fonctions pour la lightbox
        function openLightbox(imageSrc, vehicleName) {
            const lightbox = document.getElementById('lightbox');
            const lightboxImage = document.getElementById('lightbox-image');
            
            lightboxImage.src = imageSrc;
            lightboxImage.alt = vehicleName || 'Image du véhicule';
            lightbox.style.display = 'flex';
            lightbox.classList.add('show');
            
            // Empêcher le scroll de la page
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('show');
            lightbox.style.display = 'none';
            
            // Rétablir le scroll de la page
            document.body.style.overflow = 'auto';
        }

        // Fermer la lightbox avec la touche Échap
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeLightbox();
            }
        });

        // Fonction pour réinitialiser tous les véhicules
        async function resetVehicles() {
            if (!confirm('⚠️ ATTENTION ⚠️\n\nÊtes-vous sûr de vouloir supprimer TOUS les véhicules ?\n\nCette action est irréversible !')) {
                return;
            }

            try {
                console.log('🗑️ Début de la réinitialisation...');
                
                // Supprimer de Firebase si connecté
                if (firebaseConnected) {
                    console.log('🔥 Suppression de tous les véhicules dans Firebase...');
                    
                    // Récupérer tous les documents
                    const snapshot = await db.collection('vehicles').get();
                    
                    // Supprimer chaque document
                    const deletePromises = [];
                    snapshot.forEach(doc => {
                        deletePromises.push(db.collection('vehicles').doc(doc.id).delete());
                    });
                    
                    await Promise.all(deletePromises);
                    console.log('✅ Tous les véhicules supprimés de Firebase');
                }
                
                // Vider la liste locale
                vehicles = [];
                nextId = 1;
                
                // Nettoyer le localStorage
                localStorage.removeItem('wasteland_vehicles');
                localStorage.removeItem('wasteland_nextId');
                
                // Mettre à jour les affichages
                renderAdminVehicleList();
                renderVehicles();
                
                showMessage('✅ Tous les véhicules ont été supprimés avec succès !', 'success');
                console.log('✅ Réinitialisation terminée');
                
            } catch (error) {
                console.error('❌ Erreur lors de la réinitialisation:', error);
                showMessage(`❌ Erreur lors de la réinitialisation: ${error.message}`, 'error');
            }
        }

        function showMessage(text, type) {
            const container = document.getElementById('message-container');
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            
            container.innerHTML = '';
            container.appendChild(message);
            
            setTimeout(() => {
                message.style.opacity = '0';
                setTimeout(() => {
                    if (message.parentNode) {
                        message.parentNode.removeChild(message);
                    }
                }, 300);
            }, 3000);
        }

        function showLoginMessage(text, type) {
            const container = document.getElementById('login-message-container');
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            
            container.innerHTML = '';
            container.appendChild(message);
            
            setTimeout(() => {
                message.style.opacity = '0';
                setTimeout(() => {
                    if (message.parentNode) {
                        message.parentNode.removeChild(message);
                    }
                }, 300);
            }, 3000);
        }

        // Event Listeners
        document.getElementById('login-form-element').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            login(formData.get('username'), formData.get('password'));
        });

        document.getElementById('vehicle-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const vehicleData = {
                name: formData.get('name'),
                category: formData.get('category'),
                price: formData.get('price'),
                description: formData.get('description'),
                image: formData.get('image')
            };
            
            addVehicle(vehicleData);
            this.reset();
            document.getElementById('image-preview').style.display = 'none';
        });

        // Initialisation
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 Initialisation de l\'application...');
            await loadVehicles();
            showShop();
        });
    </script>

    <!-- Lightbox pour afficher les images en grand -->
    <div id="lightbox" class="lightbox" style="display: none;" onclick="closeLightbox()">
        <div class="lightbox-content" onclick="event.stopPropagation()">
            <span class="lightbox-close" onclick="closeLightbox()">&times;</span>
            <img id="lightbox-image" class="lightbox-image" src="" alt="">
        </div>
    </div>
</body>
</html>